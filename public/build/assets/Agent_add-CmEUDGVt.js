import L from"./Parent-CdhewzKC.js";import{r as w,c as U,w as P,o as d,a as t,f as A,b as C,e as a,g as b,F as x,d as p,i as u,v as g,j as c,n as D,t as m}from"./app-B1MnwQxF.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Sidebar-BztHXFLZ.js";import"./Header-R0qRKiDo.js";var S="https://js.stripe.com/v3",F=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var B=function(){for(var e=document.querySelectorAll('script[src^="'.concat(S,'"]')),n=0;n<e.length;n++){var l=e[n];if(F.test(l.src))return l}return null},T=function(e){var n="",l=document.createElement("script");l.src="".concat(S).concat(n);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(l),l},M=function(e,n){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"4.6.0",startTime:n})},f=null,y=null,_=null,I=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},N=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},W=function(e){return f!==null?f:(f=new Promise(function(n,l){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe){n(window.Stripe);return}try{var r=B();if(!(r&&e)){if(!r)r=T(e);else if(r&&_!==null&&y!==null){var i;r.removeEventListener("load",_),r.removeEventListener("error",y),(i=r.parentNode)===null||i===void 0||i.removeChild(r),r=T(e)}}_=N(n,l),y=I(l),r.addEventListener("load",_),r.addEventListener("error",y)}catch(k){l(k);return}}),f.catch(function(n){return f=null,Promise.reject(n)}))},q=function(e,n,l){if(e===null)return null;var r=e.apply(void 0,n);return M(r,l),r},h,E=!1,O=function(){return h||(h=W(null).catch(function(e){return h=null,Promise.reject(e)}),h)};Promise.resolve().then(function(){return O()}).catch(function(s){E||console.warn(s)});var R=function(){for(var e=arguments.length,n=new Array(e),l=0;l<e;l++)n[l]=arguments[l];E=!0;var r=Date.now();return O().then(function(i){return q(i,n,r)})};const G={components:{Parent:L},data(){var s,e,n,l,r;return{brands:"",products:"",parts:"",form:{brand_id:"",product_id:"",parts:[],description:"",address:((n=(e=(s=this==null?void 0:this.$page)==null?void 0:s.props)==null?void 0:e.addresses[0])==null?void 0:n.id)??"other",address_text:"",cardToken:"",isTax:"yes",payment_method:"Credit Card",card_holder_name:(l=this.$page.props.auth.user)==null?void 0:l.name,card_holder_phone_number:(r=this.$page.props.auth.user)==null?void 0:r.mobile},stripe:null,card:null,cardErrorMessage:"",btnDisabled:!1}},methods:{initializeStripe(){let s=this;R(s.$page.props.pk).then(n=>{s.stripe=n,s.stripeLoaded=!0;let l=s.stripe.elements();s.card=l.create("card")})},createToken(){let s=this;s.btnDisabled=!0,s.form.payment_method!="Credit Card"&&s.saveOrders(),s.cardErrorMessage="",s.stripe.createToken(s.card).then(function(e){var n;if(e.error){s.cardErrorMessage=((n=e==null?void 0:e.error)==null?void 0:n.message)??"Payment cannot be made. Try again later.",s.btnDisabled=!0;return}s.form.cardToken=e.token.id,s.saveOrders(),s.btnDisabled=!1})},saveOrders(){this.$inertia.post(route("agent.orders.save"),this.form)},selectBrand:function(s){this.form.brand_id="",this.form.product_id="",this.form.parts=[],this.products="",this.parts="",$("#brand-"+s.id).hasClass("active-item")?$(".brand").removeClass("active-item"):($(".brand").removeClass("active-item"),$("#brand-"+s.id).addClass("active-item"),this.form.brand_id=s.id,this.products=s.products)},selectProduct:function(s){if(this.form.product_id="",this.form.parts=[],this.parts="",$("#product-"+s.id).hasClass("active-item"))$(".product").removeClass("active-item");else{$(".product").removeClass("active-item"),$("#product-"+s.id).addClass("active-item"),this.form.product_id=s.id,this.parts=s.product_parts;let e=this;setTimeout(()=>{e.card.mount(this.$refs.card)},250)}},selectPart:function(s){$("#part-"+s.id).hasClass("active-item")?($("#part-"+s.id).removeClass("active-item"),this.form.parts=this.form.parts.filter(e=>e!==s.id)):($("#part-"+s.id).addClass("active-item"),this.form.parts.includes(s.id)||this.form.parts.push(s.id))},checkPaymentOptions:function(){this.form.isTax=="no"?this.form.payment_method="Cash":this.form.payment_method="Credit Card"},filterPartsByIds:function(s){return(this.parts&&this.parts.length>0?this.parts:[]).filter(n=>s.includes(n.id))}},computed:{getPricing:function(){let s=0,e=0,n=0,l=0;return this.form.isTax=="yes"&&(s=21),this.form.parts&&this.form.parts.length>0&&this.filterPartsByIds(this.form.parts).forEach(i=>{n=parseFloat(n)+parseFloat(i.agent_price)}),n>0&&s>0&&(e=parseFloat(n)*(parseInt(s)/100)),l=parseFloat(n)+parseFloat(e),[s,e,n,l]}},mounted(){this.brands=this.$page.props.brands,this.initializeStripe()}},z={class:"container-fluid"},H={class:"row"},X={class:"col text-right"},J={class:"p-5 card"},K={class:"text-center"},Q={class:"row mt-4"},Y=["onClick"],Z=["id","src"],ee={class:"mt-3"},te={key:0,class:"text-center mt-3"},re={class:"row mt-4"},se=["onClick"],oe=["id","src"],ne={class:"mt-3"},le={key:1,class:"text-center mt-3"},ie={class:"row mt-4"},de=["onClick"],ae=["id","src"],me={class:"mt-3"},ue={class:"text-center"},ce={class:"text-center"},pe={class:"form-check form-check text-left"},fe={class:"form-check form-check text-left"},he={class:"text-center"},ve={class:"form-check form-check text-left"},be=["onUpdate:modelValue","id","value"],xe=["for"],ge={class:"form-check form-check text-left"},ye={key:0,class:"text-center"},_e={class:"text-left mt-5"},ke={class:"form-check form-check"},Ce={key:0,class:"form-check form-check"},we={key:1,class:"form-check form-check"},Pe={class:"text-left mb-2"},Te={class:"form-group"},Se={class:"text-left mb-2"},Ee={class:"form-group"},Oe={class:"text-left mb-2"},Ve={ref:"card",style:{border:"1px solid lightgray",padding:"0.7em","border-radius":"6px"}},Le={key:0,class:"text-danger"},Ue={class:"row"},Ae={class:"text-right mt-3 col"},De={class:"mb-3"},je={class:"row"},Fe={class:"text-right mt-0 col"},Be={class:"mb-3"},Me={class:"row"},Ie={class:"text-right mt-0 col"},Ne={class:"mb-3"},We={class:"row"},qe={class:"text-right mt-0 col"},Re={class:"mb-3"},Ge={class:"text-center mt-3"},ze=["disabled"];function He(s,e,n,l,r,i){const k=w("Link"),V=w("parent");return d(),U(V,null,{default:P(()=>[t("div",z,[t("div",H,[e[14]||(e[14]=t("div",{class:"col"},[t("h3",{class:"mb-4"},"Create Orders")],-1)),t("div",X,[A(k,{class:"btn btn-primary",href:s.route("agent.orders.index")},{default:P(()=>e[13]||(e[13]=[C("View Orders")])),_:1},8,["href"])])]),t("div",J,[t("div",K,[e[15]||(e[15]=t("h3",null,"Select Brand",-1)),t("div",Q,[(d(!0),a(x,null,b(r.brands,o=>(d(),a("div",{class:"col-4 m-auto",key:o.id,onClick:v=>i.selectBrand(o)},[t("img",{id:"brand-"+o.id,src:o.image,alt:"",class:"brand rounded",style:{width:"200px",height:"auto"}},null,8,Z),t("h4",ee,m(o.name),1)],8,Y))),128))])]),r.products?(d(),a("div",te,[e[16]||(e[16]=t("br",null,null,-1)),e[17]||(e[17]=t("br",null,null,-1)),e[18]||(e[18]=t("br",null,null,-1)),e[19]||(e[19]=t("h3",null,"Select Product",-1)),t("div",re,[(d(!0),a(x,null,b(r.products,o=>(d(),a("div",{class:"col-4 m-auto",key:o.id,onClick:v=>i.selectProduct(o)},[t("img",{id:"product-"+o.id,src:"/"+o.path,alt:"",class:"product rounded",style:{width:"200px",height:"auto"}},null,8,oe),t("h4",ne,m(o.name),1)],8,se))),128))])])):p("",!0),r.parts&&r.parts.length?(d(),a("div",le,[e[43]||(e[43]=t("br",null,null,-1)),e[44]||(e[44]=t("br",null,null,-1)),e[45]||(e[45]=t("br",null,null,-1)),e[46]||(e[46]=t("h3",null,"Select Part",-1)),t("div",ie,[(d(!0),a(x,null,b(r.parts,o=>(d(),a("div",{class:"col-4 m-auto",key:o.id,onClick:v=>i.selectPart(o)},[t("img",{id:"part-"+o.id,src:"/images/"+o.name.toLowerCase()+".jpg",alt:"",class:"part rounded",style:{width:"200px",height:"auto"}},null,8,ae),t("h4",me,[C(m(o.name)+" - ",1),t("b",null,"€"+m(o.agent_price),1)])],8,de))),128))]),t("div",ue,[e[20]||(e[20]=t("br",null,null,-1)),e[21]||(e[21]=t("br",null,null,-1)),e[22]||(e[22]=t("br",null,null,-1)),e[23]||(e[23]=t("h3",{class:"mb-4"},"Description",-1)),u(t("textarea",{rows:"5",class:"form-control",placeholder:"Enter order description here...","onUpdate:modelValue":e[0]||(e[0]=o=>r.form.description=o)},null,512),[[g,r.form.description]])]),t("div",ce,[e[26]||(e[26]=t("br",null,null,-1)),e[27]||(e[27]=t("br",null,null,-1)),e[28]||(e[28]=t("br",null,null,-1)),e[29]||(e[29]=t("h3",{class:"mb-4"},"Select Tax Option",-1)),t("div",pe,[u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.form.isTax=o),onChange:e[2]||(e[2]=o=>i.checkPaymentOptions()),class:"form-check-input",type:"radio",name:"taxOptions",id:"withTax",value:"yes"},null,544),[[c,r.form.isTax]]),e[24]||(e[24]=t("label",{class:"form-check-label",for:"withTax"},[t("b",null,"Payment With Tax")],-1))]),t("div",fe,[u(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>r.form.isTax=o),onChange:e[4]||(e[4]=o=>i.checkPaymentOptions()),class:"form-check-input",type:"radio",name:"taxOptions",id:"withoutTax",value:"no"},null,544),[[c,r.form.isTax]]),e[25]||(e[25]=t("label",{class:"form-check-label",for:"withoutTax"},[t("b",null,"Payment Without Tax")],-1))])]),t("div",he,[e[31]||(e[31]=t("br",null,null,-1)),e[32]||(e[32]=t("br",null,null,-1)),e[33]||(e[33]=t("br",null,null,-1)),e[34]||(e[34]=t("h3",{class:"mb-4"},"Saved Addresses",-1)),(d(!0),a(x,null,b(s.$page.props.addresses,o=>(d(),a("div",ve,[u(t("input",{"onUpdate:modelValue":v=>r.form.address=v,class:"form-check-input",type:"radio",name:"addressOptions",id:"order"+o.id,value:o.id},null,8,be),[[c,r.form.address]]),t("label",{class:"form-check-label",for:"order"+o.id},[t("b",null,m(o.title),1),C(" | "+m(o.address)+" | Ph. "+m(o.phone??"N/A"),1)],8,xe)]))),256)),t("div",ge,[u(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>r.form.address=o),class:"form-check-input",type:"radio",name:"addressOptions",id:"otherAddress",value:"other"},null,512),[[c,r.form.address]]),e[30]||(e[30]=t("label",{class:"form-check-label",for:"otherAddress"},[t("b",null,"Other Address")],-1))])]),r.form.address=="other"?(d(),a("div",ye,[u(t("textarea",{rows:"5",class:"form-control",placeholder:"Enter address here...","onUpdate:modelValue":e[6]||(e[6]=o=>r.form.address_text=o)},null,512),[[g,r.form.address_text]])])):p("",!0),t("div",_e,[e[38]||(e[38]=t("h3",{class:"mb-3"},"Payment Method",-1)),t("div",ke,[u(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>r.form.payment_method=o),class:"form-check-input",type:"radio",name:"paymentOptions",id:"cash",value:"Cash"},null,512),[[c,r.form.payment_method]]),e[35]||(e[35]=t("label",{class:"form-check-label",for:"cash"},[t("b",null,"Cash On Delivery")],-1))]),r.form.isTax=="yes"?(d(),a("div",Ce,[u(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>r.form.payment_method=o),class:"form-check-input",type:"radio",name:"paymentOptions",id:"card_on_delivery",value:"Card On Delivery"},null,512),[[c,r.form.payment_method]]),e[36]||(e[36]=t("label",{class:"form-check-label",for:"card_on_delivery"},[t("b",null,"Card On Delivery")],-1))])):p("",!0),r.form.isTax=="yes"?(d(),a("div",we,[u(t("input",{"onUpdate:modelValue":e[9]||(e[9]=o=>r.form.payment_method=o),class:"form-check-input",type:"radio",name:"paymentOptions",id:"card",value:"Credit Card"},null,512),[[c,r.form.payment_method]]),e[37]||(e[37]=t("label",{class:"form-check-label",for:"card"},[t("b",null,"Card Payment")],-1))])):p("",!0)]),t("div",{class:D(["text-left mt-5",r.form.payment_method=="Credit Card"?"d-block":"d-none"])},[e[42]||(e[42]=t("hr",null,null,-1)),t("div",Pe,[e[39]||(e[39]=t("label",null,[t("b",null,"Card Holder Name")],-1)),t("div",Te,[u(t("input",{placeholder:"Enter card holder name","onUpdate:modelValue":e[10]||(e[10]=o=>r.form.card_holder_name=o),class:"form-control",type:"text",required:""},null,512),[[g,r.form.card_holder_name]])])]),t("div",Se,[e[40]||(e[40]=t("label",null,[t("b",null,"Card Holder Phone Number")],-1)),t("div",Ee,[u(t("input",{placeholder:"Enter card holder name","onUpdate:modelValue":e[11]||(e[11]=o=>r.form.card_holder_phone_number=o),class:"form-control",type:"text",required:""},null,512),[[g,r.form.card_holder_phone_number]])])]),t("div",Oe,[e[41]||(e[41]=t("label",null,[t("b",null,"Card Information")],-1)),t("div",Ve,null,512),r.cardErrorMessage?(d(),a("span",Le,m(r.cardErrorMessage),1)):p("",!0)])],2)])):p("",!0),t("div",Ue,[e[47]||(e[47]=t("div",{class:"text-left mt-3 col"},[t("h5",{class:"mb-3"},"Sub Total")],-1)),t("div",Ae,[t("h5",De,"€ "+m(i.getPricing[2].toFixed(2)),1)])]),t("div",je,[e[48]||(e[48]=t("div",{class:"text-left mt-0 col"},[t("h5",{class:"mb-3"},"Tax(%)")],-1)),t("div",Fe,[t("h5",Be,m(i.getPricing[0]+"%"),1)])]),t("div",Me,[e[49]||(e[49]=t("div",{class:"text-left mt-0 col"},[t("h5",{class:"mb-3"},"Tax Amount")],-1)),t("div",Ie,[t("h5",Ne,"€ "+m(i.getPricing[1].toFixed(2)),1)])]),t("div",We,[e[50]||(e[50]=t("div",{class:"text-left mt-0 col"},[t("h5",{class:"mb-3"},"Grand Total")],-1)),t("div",qe,[t("h5",Re,"€ "+m(i.getPricing[3].toFixed(2)),1)])]),t("div",Ge,[e[51]||(e[51]=t("hr",null,null,-1)),t("button",{class:"btn btn-primary btn-lg",disabled:!(r.form.brand_id&&r.form.product_id&&r.form.parts.length&&r.form.address)||r.btnDisabled,onClick:e[12]||(e[12]=(...o)=>i.createToken&&i.createToken(...o))},"Create Order",8,ze)])])])]),_:1})}const Ze=j(G,[["render",He]]);export{Ze as default};

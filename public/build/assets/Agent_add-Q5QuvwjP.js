import D from"./Parent-LvxNQG8o.js";import{r as w,o as d,c as V,w as S,a as e,f as B,b as C,t as c,e as a,g as v,F as b,d as h,i as x,v as y}from"./app-81tNAsjg.js";import{_ as M}from"./_plugin-vue_export-helper-x3n3nnut.js";import"./Sidebar-ACOzqr4J.js";import"./Header-ja6GT2We.js";var P="https://js.stripe.com/v3",O=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,E="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",A=function(){for(var r=document.querySelectorAll('script[src^="'.concat(P,'"]')),n=0;n<r.length;n++){var o=r[n];if(O.test(o.src))return o}return null},k=function(r){var n=r&&!r.advancedFraudSignals?"?advancedFraudSignals=false":"",o=document.createElement("script");o.src="".concat(P).concat(n);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(o),o},F=function(r,n){!r||!r._registerWrapper||r._registerWrapper({name:"stripe-js",version:"4.6.0",startTime:n})},u=null,m=null,p=null,N=function(r){return function(){r(new Error("Failed to load Stripe.js"))}},R=function(r,n){return function(){window.Stripe?r(window.Stripe):n(new Error("Stripe.js not available"))}},U=function(r){return u!==null?u:(u=new Promise(function(n,o){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe&&r&&console.warn(E),window.Stripe){n(window.Stripe);return}try{var s=A();if(s&&r)console.warn(E);else if(!s)s=k(r);else if(s&&p!==null&&m!==null){var l;s.removeEventListener("load",p),s.removeEventListener("error",m),(l=s.parentNode)===null||l===void 0||l.removeChild(s),s=k(r)}p=R(n,o),m=N(o),s.addEventListener("load",p),s.addEventListener("error",m)}catch(f){o(f);return}}),u.catch(function(n){return u=null,Promise.reject(n)}))},W=function(r,n,o){if(r===null)return null;var s=r.apply(void 0,n);return F(s,o),s},_,L=!1,T=function(){return _||(_=U(null).catch(function(r){return _=null,Promise.reject(r)}),_)};Promise.resolve().then(function(){return T()}).catch(function(t){L||console.warn(t)});var q=function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];L=!0;var s=Date.now();return T().then(function(l){return W(l,n,s)})};const G={components:{Parent:D},data(){return{brands:"",products:"",parts:"",form:{brand_id:"",product_id:"",part_id:"",description:"",address:"",cardToken:""},stripe:null,card:null,cardErrorMessage:"",btnDisabled:!1}},methods:{initializeStripe(){let t=this;q(t.$page.props.pk).then(n=>{t.stripe=n,t.stripeLoaded=!0;let o=t.stripe.elements();t.card=o.create("card")})},createToken(){let t=this;t.btnDisabled=!0,t.cardErrorMessage="",t.stripe.createToken(t.card).then(function(r){var n;if(r.error){t.cardErrorMessage=((n=r==null?void 0:r.error)==null?void 0:n.message)??"Payment cannot be made. Try again later.",t.btnDisabled=!0;return}t.form.cardToken=r.token.id,t.saveOrders(),t.btnDisabled=!1})},saveOrders(){this.$inertia.post(route("agent.orders.save"),this.form)},selectBrand:function(t){this.form.brand_id="",this.form.product_id="",this.form.part_id="",this.products="",this.parts="",$("#brand-"+t.id).hasClass("active-item")?$(".brand").removeClass("active-item"):($(".brand").removeClass("active-item"),$("#brand-"+t.id).addClass("active-item"),this.form.brand_id=t.id,this.products=t.products)},selectProduct:function(t){if(this.form.product_id="",this.form.part_id="",this.parts="",$("#product-"+t.id).hasClass("active-item"))$(".product").removeClass("active-item");else{$(".product").removeClass("active-item"),$("#product-"+t.id).addClass("active-item"),this.form.product_id=t.id,this.parts=t.product_parts;let r=this;setTimeout(()=>{r.card.mount(this.$refs.card)},250)}},selectPart:function(t){this.form.part_id="",$("#part-"+t.id).hasClass("active-item")?$(".part").removeClass("active-item"):($(".part").removeClass("active-item"),$("#part-"+t.id).addClass("active-item"),this.form.part_id=t.id)}},mounted(){this.brands=this.$page.props.brands,this.initializeStripe()}},I={class:"container-fluid"},z={class:"row"},X=e("div",{class:"col"},[e("h3",{class:"mb-4"},"Create Orders")],-1),H={class:"col text-right"},J={class:"p-5 card"},K={class:"text-center"},Q=e("h3",null,"Select Brand",-1),Y={class:"row mt-4"},Z=["onClick"],ee=["id","src"],te={class:"mt-3"},re={key:0,class:"text-center mt-3"},se=e("br",null,null,-1),ne=e("br",null,null,-1),ie=e("br",null,null,-1),oe=e("h3",null,"Select Product",-1),le={class:"row mt-4"},de=["onClick"],ae=["id","src"],ce={class:"mt-3"},ue={key:1,class:"text-center mt-3"},_e=e("br",null,null,-1),he=e("br",null,null,-1),me=e("br",null,null,-1),pe=e("h3",null,"Select Part",-1),fe={class:"row mt-4"},ve=["onClick"],be=["id","src"],ge={class:"mt-3"},we={class:"text-center"},Se=e("br",null,null,-1),Ce=e("br",null,null,-1),xe=e("br",null,null,-1),ye=e("h3",{class:"mb-4"},"Description",-1),Ee={class:"text-center"},ke=e("br",null,null,-1),Pe=e("br",null,null,-1),Le=e("br",null,null,-1),Te=e("h3",{class:"mb-4"},"Address",-1),je={class:"text-left"},De=e("br",null,null,-1),Ve=e("br",null,null,-1),Be=e("br",null,null,-1),Me=e("h3",{class:"mb-4"},"Card Payment",-1),Oe={ref:"card",style:{border:"1px solid lightgray",padding:"1em","border-radius":"6px"}},Ae={key:0,class:"text-danger"},Fe={key:2,class:"text-center mt-3"},Ne=e("hr",null,null,-1),Re=["disabled"];function Ue(t,r,n,o,s,l){const f=w("Link"),j=w("parent");return d(),V(j,null,{default:S(()=>[e("div",I,[e("div",z,[X,e("div",H,[B(f,{class:"btn btn-primary",href:t.route("agent.orders.index")},{default:S(()=>[C("View Orders")]),_:1},8,["href"])])]),e("div",J,[e("div",K,[Q,e("h6",null,c(s.form),1),e("div",Y,[(d(!0),a(b,null,v(s.brands,i=>(d(),a("div",{class:"col-4 m-auto",key:i.id,onClick:g=>l.selectBrand(i)},[e("img",{id:"brand-"+i.id,src:i.image,alt:"",class:"brand rounded",style:{width:"200px",height:"auto"}},null,8,ee),e("h4",te,c(i.name),1)],8,Z))),128))])]),s.products?(d(),a("div",re,[se,ne,ie,oe,e("div",le,[(d(!0),a(b,null,v(s.products,i=>(d(),a("div",{class:"col-4 m-auto",key:i.id,onClick:g=>l.selectProduct(i)},[e("img",{id:"product-"+i.id,src:"/"+i.path,alt:"",class:"product rounded",style:{width:"200px",height:"auto"}},null,8,ae),e("h4",ce,c(i.name),1)],8,de))),128))])])):h("",!0),s.parts&&s.parts.length?(d(),a("div",ue,[_e,he,me,pe,e("div",fe,[(d(!0),a(b,null,v(s.parts,i=>(d(),a("div",{class:"col-4 m-auto",key:i.id,onClick:g=>l.selectPart(i)},[e("img",{id:"part-"+i.id,src:"/images/"+i.name+".jpg",alt:"",class:"part rounded",style:{width:"200px",height:"auto"}},null,8,be),e("h4",ge,[C(c(i.name)+" - ",1),e("b",null,"â‚¬"+c(i.agent_price),1)])],8,ve))),128))]),e("div",we,[Se,Ce,xe,ye,x(e("textarea",{rows:"5",class:"form-control",placeholder:"Enter order description here...","onUpdate:modelValue":r[0]||(r[0]=i=>s.form.description=i)},null,512),[[y,s.form.description]])]),e("div",Ee,[ke,Pe,Le,Te,x(e("textarea",{rows:"5",class:"form-control",placeholder:"Enter address here...","onUpdate:modelValue":r[1]||(r[1]=i=>s.form.address=i)},null,512),[[y,s.form.address]])]),e("div",je,[De,Ve,Be,Me,e("div",Oe,null,512),s.cardErrorMessage?(d(),a("span",Ae,c(s.cardErrorMessage),1)):h("",!0)])])):h("",!0),s.form.brand_id&&s.form.product_id&&s.form.part_id&&s.form.address?(d(),a("div",Fe,[Ne,e("button",{class:"btn btn-primary btn-lg",onClick:r[2]||(r[2]=(...i)=>l.createToken&&l.createToken(...i)),disabled:s.btnDisabled},"Create Order",8,Re)])):h("",!0)])])]),_:1})}const Xe=M(G,[["render",Ue]]);export{Xe as default};
